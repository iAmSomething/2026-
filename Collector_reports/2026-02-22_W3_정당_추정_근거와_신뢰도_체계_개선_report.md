# [COLLECTOR][W3] 정당 추정 근거와 신뢰도 체계 개선 보고서 (#182)

- 보고일: 2026-02-22
- 작성자: Codex (Collector 담당)
- 대상 이슈: `#182` `[COLLECTOR][W3] 정당 미기재 후보 소속 추정 v2`

## 1. 완료 요약
1. 정당 추정 v2를 별도 구현해 `office_type 기반 sg_typecode 선택`과 `Data.go pageNo pagination`을 반영했습니다.
2. 추정 결과에 `confidence_tier`와 `support_count/support_total` 근거 필드를 추가해 신뢰도 체계를 고정했습니다.
3. 동일 50건 샘플 기준 v1 대비 추정 커버리지를 `5 -> 25`로 개선했습니다.

## 2. 구현 변경
1. 신규 스크립트
- `/Users/gimtaehun/election2026_codex/scripts/generate_collector_party_inference_v2_batch50.py`
- 주요 변경점
  - 입력을 `data/collector_enrichment_v2_batch.json`으로 상향
  - Data.go 조회를 `office_type -> sg_typecodes` 매핑으로 확장
  - `pageNo` 다중 페이지 조회(최대 8페이지) + 중복 제거
  - 추정 신뢰도 구조화:
    - `party_inference_confidence_tier` (`high/mid/low/none`)
    - `party_inference_support_count`
    - `party_inference_support_total`
  - `conflicting_party_signals` 차단 규칙 추가

2. 신규 테스트
- `/Users/gimtaehun/election2026_codex/tests/test_collector_party_inference_v2_batch_script.py`
- 검증 항목
  - 지역 Data.go 근거 우선
  - context registry fallback
  - 상충 신호 차단

## 3. 실행 결과 (v1 -> v2)
1. 배치 실행
- 명령: `PYTHONPATH=. .venv/bin/python scripts/generate_collector_party_inference_v2_batch50.py`
- 산출물:
  - `/Users/gimtaehun/election2026_codex/data/collector_party_inference_v2_batch50.json`
  - `/Users/gimtaehun/election2026_codex/data/collector_party_inference_v2_eval.json`

2. 핵심 지표 비교 (동일 50건)
- `candidate_target_count`: `98 -> 98`
- `candidate_inferred_count`: `5 -> 25` (`+20`)
- `candidate_high_conf_count`: `5 -> 25` (`+20`)
- `inference_coverage`: `0.051 -> 0.2551`
- `review_queue_count`: `93 -> 73` (`-20`)

3. 소스 분포 변화
- v1: `latest_candidate_registry=5`
- v2:
  - `data_go_candidate_api_region=17`
  - `latest_candidate_registry_v2=4`
  - `context_registry_v2=4`

4. 신뢰도 분포(v2)
- `high=21`, `mid=4`, `none=73`

## 4. 테스트 결과
1. `PYTHONPATH=. .venv/bin/pytest -q tests/test_collector_party_inference_v2_batch_script.py`
- 결과: `5 passed`
2. `PYTHONPATH=. .venv/bin/pytest -q tests/test_collector_party_inference_v1_batch_script.py tests/test_collector_party_inference_v2_batch_script.py`
- 결과: `8 passed`

## 5. DoD 체크
1. 구현/설계/검증 반영: **완료**
2. 보고서 제출: **완료**
3. 이슈 코멘트(report_path/evidence/next_status): **완료 예정(본 보고서 제출 직후)**

## 6. 증빙 파일
1. `/Users/gimtaehun/election2026_codex/data/collector_party_inference_v2_eval.json`
2. `/Users/gimtaehun/election2026_codex/data/collector_party_inference_v2_batch50.json`
3. `/Users/gimtaehun/election2026_codex/scripts/generate_collector_party_inference_v2_batch50.py`
4. `/Users/gimtaehun/election2026_codex/tests/test_collector_party_inference_v2_batch_script.py`

## 7. 의사결정 요청
1. `confidence_tier=mid`(0.75~0.849) 후보를 자동 확정(`party_name` 반영)할지, review-only로 둘지 정책 확정 필요.
2. `context_registry_v2` 근거(기사 문맥 집계) 사용 허용 범위를 운영에서 유지할지, Data.go 기반 근거만 자동 확정할지 기준 확정 필요.
