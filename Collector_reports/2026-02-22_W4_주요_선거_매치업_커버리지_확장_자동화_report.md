# [COLLECTOR][W4] 주요 선거 매치업 커버리지 확장 자동화 보고서 (#188)

- 보고일: 2026-02-22
- 작성자: Codex (Collector 담당)
- 대상 이슈: `#188` `[COLLECTOR][W4] 30일 커버리지 자동 확장 배치 v2`

## 1. 완료 요약
1. live coverage v2 자동 확장 스크립트를 신규 구현해 `최근 30일 + 30건` 데이터팩을 생성했습니다.
2. `web demo(전국/광역 seed) + party inference v2(기초단체 확장) + NESDC 최근등록` 3소스 결합으로 매치업 커버리지를 확대했습니다.
3. v1 대비 커버리지 지표를 개선했습니다.
   - records: `20 -> 30`
   - unique_matchups: `18 -> 26`
   - unique_local_sigungu_regions: `15 -> 23`

## 2. 구현 변경
1. 신규 스크립트
- `/Users/gimtaehun/election2026_codex/scripts/generate_collector_live_coverage_v2_pack.py`
- 핵심 변경
  - 목표 레코드 수 `30`으로 상향
  - local seed를 `collector_party_inference_v2_batch50` 기반으로 선별
  - 지역 분산 우선(`MIN_LOCAL_UNIQUE_REGIONS=12`) + 매치업 중복 억제
  - 30일 윈도우 강제(`survey_end_within_30d_all`)
  - local 후보 정당 채움률 지표(`local_candidate_party_fill_rate`) 포함

2. 신규 테스트
- `/Users/gimtaehun/election2026_codex/tests/test_collector_live_coverage_v2_pack_script.py`
- 검증 항목
  - acceptance check 통과
  - 필수 메타 존재
  - 고정일자 기준 idempotent

## 3. 실행 결과
1. 배치 실행
- 명령: `PYTHONPATH=. .venv/bin/python scripts/generate_collector_live_coverage_v2_pack.py`
- 산출물
  - `/Users/gimtaehun/election2026_codex/data/collector_live_coverage_v2_payload.json`
  - `/Users/gimtaehun/election2026_codex/data/collector_live_coverage_v2_report.json`
  - `/Users/gimtaehun/election2026_codex/data/collector_live_coverage_v2_review_queue_candidates.json`

2. 주요 지표(v2)
- `records=30`
- `unique_matchups=26`
- `unique_local_sigungu_regions=23`
- `source_channel_counts`: `article=22`, `nesdc=8`
- `local_candidate_party_fill_rate=0.28`
- `review_queue_candidate_count=0`

3. acceptance_checks
- `records_ge_30=true`
- `dual_source_present=true`
- `national_indicator_present=true`
- `metro_matchup_present=true`
- `local_sigungu_ge_12=true`
- `unique_matchup_ge_24=true`
- `survey_end_within_30d_all=true`
- `local_candidate_party_fill_rate_ge_02=true`

## 4. 테스트 결과
1. `PYTHONPATH=. .venv/bin/pytest -q tests/test_collector_live_coverage_v2_pack_script.py`
- 결과: `3 passed`
2. `PYTHONPATH=. .venv/bin/pytest -q tests/test_collector_live_coverage_v1_pack_script.py tests/test_collector_live_coverage_v2_pack_script.py`
- 결과: `5 passed`

## 5. DoD 체크
1. 구현/설계/검증 반영: **완료**
2. 보고서 제출: **완료**
3. 이슈 코멘트(report_path/evidence/next_status): **완료 예정(본 보고서 제출 직후)**

## 6. 증빙 파일
1. `/Users/gimtaehun/election2026_codex/data/collector_live_coverage_v2_payload.json`
2. `/Users/gimtaehun/election2026_codex/data/collector_live_coverage_v2_report.json`
3. `/Users/gimtaehun/election2026_codex/data/collector_live_coverage_v2_review_queue_candidates.json`
4. `/Users/gimtaehun/election2026_codex/scripts/generate_collector_live_coverage_v2_pack.py`
5. `/Users/gimtaehun/election2026_codex/tests/test_collector_live_coverage_v2_pack_script.py`

## 7. 의사결정 요청
1. `local_candidate_party_fill_rate` 운영 하한을 현재 0.20으로 둘지, 0.30 이상으로 상향할지 정책 확정 필요.
2. v2 자동확장 배치의 정기 실행 주기(일 1회 vs 6시간)와 실패 시 재시도 정책(재실행 횟수/간격) 확정 필요.
